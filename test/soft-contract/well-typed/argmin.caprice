(* TEST
  typing = no-error;
  flags += " -t 2.0"; # small timeout
  speed = slow;
  typecheck;
*)

let is_cons xs =
  match xs with
  | _ :: _ -> true
  | _ -> false
  end

let rec argmin_acc f a b xs =
  match xs with
  | [] -> a
  | hd :: tl ->
    if b < f hd
    then argmin_acc f a b tl
    else argmin_acc f hd (f hd) tl
  end

let argmin (type a) (f : a -> int) (xs : list a | is_cons xs) : a =
  match xs with
  | hd :: tl -> argmin_acc f hd (f hd) tl
  end
