(* TEST
  include splayable;
*)

let is_cons xs =
  match xs with
  | _ :: _ -> true
  | _ -> false
  end

let min x y =
  match x, y with
  | (a, fa), (b, fb) -> if fa < fb then x else y
  end

let rec argmin (type a) (f : a -> int) (xs : list a | is_cons xs) : a * int =
  match xs with
  | x :: [] -> x, f x
  | x :: rest -> min (x, f x) (argmin a f rest)
  end
