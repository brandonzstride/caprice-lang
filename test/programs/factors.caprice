(* TEST
  include splayable;
*)


let pos_int = { i : int | i > 0 }

let factors (n : pos_int) : list pos_int =
  let rec factors (dependent i : pos_int) : list { k : int | k >= i } =
    if i > n then
      []
    else if n % i == 0 then
      i :: factors (i + 1)
    else
      factors (i + 1)
  in
  factors 1
