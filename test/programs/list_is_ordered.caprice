(* TEST
  include exhaustible;
*)


(* Any refinements for orderedness will not work because they are recursive,
   so here we just use OCaml-like, non-refined types. *)
let rec is_ordered (type a) (ls : list a) (cmp : a -> a -> int) : bool =
  match ls with
  | [] -> true
  | x :: [] -> true
  | x :: (y :: _ as tl) ->
    cmp x y < 1 && is_ordered a tl cmp
  end
