(* TEST
  include finitely-exhaustible;
*)


(* Generated function should pass *)
let f (type a b) (g : a -> list b) : a -> list b =
  g

(* Generated dependent function is a regular function *)
let f (dep k : int) (g : (i : int | i > k) -> if i > 10 then list int else bool) 
  : { i : int | i > 10 && i > k } -> list int =
  g

(* Generated function can check as a dependent function *)
let f (g : { i : int | i > 0 } -> { j : int | j < 0 })
  : (i : int | i > 0) -> if i < 10 then int else { j : int | j < 0 } =
  g

(* Generated dependent function subtyping *)
let f (g : (x : { a : int }) -> if x.a > 0 then { b : bool | b == (x.a == 10)} else { i : int | i == x.a })
  : (y : { a : int ; b : bool }) -> if y.a > 0 then bool else int =
  g
