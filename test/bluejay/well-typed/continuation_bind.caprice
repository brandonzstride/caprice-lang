
(* TEST
  include finite-well-typed;
*)

let t : type -> type -> type = fun a r -> { continuation : (a -> r) -> r }

let bind (type a' b' r') (ar_r : t a' r') : (a' -> t b' r') -> t b' r' = 
  fun a_br_r ->
    { continuation = 
      fun br -> ar_r.continuation (fun a -> (a_br_r a).continuation br)
    }

let int_bind (type b' r') (i_br_r : int -> t b' r') : t b' r' =
  bind int b' r' { continuation = fun ir -> ir 0 } i_br_r
